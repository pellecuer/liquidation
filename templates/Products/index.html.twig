{% extends 'base.html.twig' %}
{% block stylesheets %}
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js">
    <link rel="stylesheet" href="{{ asset('build/datatable.css') }}">
{% endblock %}

{% block title %}Accueil{% endblock %}

{% block HeaderTitlePart1 %} Merci {% endblock %}
{% block HeaderTitlePart2 %}pour votre confiance{% endblock %}



{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-8 offset-2">
                <h1>Voici la liste des produits</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8 offset-2">
                <table id="myTable" class=" table table-striped table-hover table-sm">
                    <caption>Liste des produits</caption>
                    <thead class="thead-dark">
                    <tr>
                        <th scope ="col" >Id</th>
                        <th scope ="col">Marque</th>
                        <th scope ="col">Prix conseillé</th>
                        <th scope ="col">Prix</th>
                        <th scope ="col">Quantité</th>
                        <th scope ="col">Taille</th>
                        <th scope ="col">Couleur</th>
                        <th scope ="col"></th>
                        <th scope ="col"></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for product in products %}
                        <tr>
                            <td class="editFor">{{ product.id }}</td>
                            <td class="editFor">{{ product.Brand }}</td>
                            <td class="editFor">{{ product.PriceAdvized }}</td>
                            <td class="editFor">{{ product.price }}</td>
                            <td class="editFor">{{ product.Quantity }}</td>
                            <td class="editFor">{{ product.Size }}</td>
                            <td class="editFor">{{ product.Color }}</td>
                            <td class="update" scope ="col"><i class="fas fa-check"></i></td>
                            <td class="trash" scope ="col"><i class="fas fa-trash-alt"></i></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <h2>Description : <span id="titre"></span></h2>
        <h2>Détail : <span id="producteur"></span></h2>
        <h2>Affiche var : <span id="var"></span></h2>
    </div>
{% endblock %}
 {% block javascripts %}
     <script>
         //Event handlers
         $(".editFor" ).on( "mouseenter", function(){
             $( this).css( "background-color", "#C6E2FF");
             //$('html,body').css('cursor','crosshair');
             $(this).attr('contenteditable', 'true');
         });
         $(".editFor" ).on( "mouseleave", function(){
             $( this).css( "background-color", "#F0F8FF");
             //$('html,body').css('cursor','crosshair');
             $(this).attr('contenteditable', 'false');
         });
         $(".editFor" ).on( "keypress", function(){
             //$('html,body').css('cursor','crosshair');
             $(this).text('');
         });

         //Check
         $('.editFor').on( "keyup", function(){
             var personnage = $(this).html();
             $.ajax({
                 url:'/ajax_request',
                 type: "POST",
                 dataType: "json",
                 data: {
                     "personnage": personnage
                 },
                 async: true,
                 success: function (data)
                 {
                     console.log(data);
                     $( '#titre' ).text(data.titre);
                     $( '#producteur' ).text(data.producteur);
                 }
             });
         });

         //delete object in DB
         $('.trash').on( "click", function(){
             //$(this).closest('tr').remove();
             var personnage = $(this).closest('tr').find("td:nth-child(1)").html();

             $( '#var' ).text(personnage);
         });

         //update object in DB
         $('.update').on( "click", function(){
             //$(this).closest('tr').remove();
             var personnage = $(this).closest('tr').find("td:nth-child(1)").html();

             $( '#var' ).text(personnage);
         });
     </script>
 {% endblock %}